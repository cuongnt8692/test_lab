function cnet = func_correct_WB_CNN( cnet, input, p, errC1, errS1, errC2,errS2, errN, yC1, yS1, yC2, yS2, output)

%%
% output/ Layer N
    WN001=cnet.WN001;
    WN002=cnet.WN002;
    WN003=cnet.WN003;
    WN004=cnet.WN004;
    WN005=cnet.WN005;
    WN006=cnet.WN006;
    WN007=cnet.WN007;
    WN008=cnet.WN008;
    WN009=cnet.WN009;
    WN010=cnet.WN010;
    WN011=cnet.WN011;
    WN012=cnet.WN012;
    WN013=cnet.WN013;
    WN014=cnet.WN014;
    WN015=cnet.WN015;
    WN016=cnet.WN016;
    WN017=cnet.WN017;
    WN018=cnet.WN018;
    WN019=cnet.WN019;
    WN020=cnet.WN020;
    WN021=cnet.WN021;
    WN022=cnet.WN022;
    WN023=cnet.WN023;
    WN024=cnet.WN024;
    WN025=cnet.WN025;
    WN026=cnet.WN026;
    WN027=cnet.WN027;
    WN028=cnet.WN028;
    WN029=cnet.WN029;
    WN030=cnet.WN030;
    WN031=cnet.WN031;
    WN032=cnet.WN032;
    WN033=cnet.WN033;
    WN034=cnet.WN034;
    WN035=cnet.WN035;
    WN036=cnet.WN036;
    WN037=cnet.WN037;
    WN038=cnet.WN038;
    WN039=cnet.WN039;
    WN040=cnet.WN040;
    WN041=cnet.WN041;
    WN042=cnet.WN042;
    WN043=cnet.WN043;
    WN044=cnet.WN044;
    WN045=cnet.WN045;
    WN046=cnet.WN046;
    WN047=cnet.WN047;
    WN048=cnet.WN048;
    WN049=cnet.WN049;
    WN050=cnet.WN050;
    WN051=cnet.WN051;
    WN052=cnet.WN052;
    WN053=cnet.WN053;
    WN054=cnet.WN054;
    WN055=cnet.WN055;
    WN056=cnet.WN056;
    WN057=cnet.WN057;
    WN058=cnet.WN058;
    WN059=cnet.WN059;
    WN060=cnet.WN060;
    WN061=cnet.WN061;
    WN062=cnet.WN062;
    WN063=cnet.WN063;
    WN064=cnet.WN064;
    WN065=cnet.WN065;
    WN066=cnet.WN066;
    WN067=cnet.WN067;
    WN068=cnet.WN068;
    WN069=cnet.WN069;
    WN070=cnet.WN070;
    WN071=cnet.WN071;
    WN072=cnet.WN072;
    WN073=cnet.WN073;
    WN074=cnet.WN074;
    WN075=cnet.WN075;
    WN076=cnet.WN076;
    WN077=cnet.WN077;
    WN078=cnet.WN078;
    WN079=cnet.WN079;
    WN080=cnet.WN080;
    WN081=cnet.WN081;
    WN082=cnet.WN082;
    WN083=cnet.WN083;
    WN084=cnet.WN084;
    WN085=cnet.WN085;
    WN086=cnet.WN086;
    WN087=cnet.WN087;
    WN088=cnet.WN088;
    WN089=cnet.WN089;
    WN090=cnet.WN090;
    WN091=cnet.WN091;
    WN092=cnet.WN092;
    WN093=cnet.WN093;
    WN094=cnet.WN094;
    WN095=cnet.WN095;
    WN096=cnet.WN096;
    WN097=cnet.WN097;
    WN098=cnet.WN098;
    WN099=cnet.WN099;
    WN100=cnet.WN100;
    WN101=cnet.WN101;
    WN102=cnet.WN102;
    WN103=cnet.WN103;
    WN104=cnet.WN104;
    WN105=cnet.WN105;
    WN106=cnet.WN106;
    WN107=cnet.WN107;
    WN108=cnet.WN108;
    WN109=cnet.WN109;
    WN110=cnet.WN110;
    WN111=cnet.WN111;
    WN112=cnet.WN112;
    WN113=cnet.WN113;
    WN114=cnet.WN114;
    WN115=cnet.WN115;
    WN116=cnet.WN116;
    WN117=cnet.WN117;
    WN118=cnet.WN118;
    WN119=cnet.WN119;
    WN120=cnet.WN120;
    WN121=cnet.WN121;
    WN122=cnet.WN122;
    WN123=cnet.WN123;
    WN124=cnet.WN124;
    WN125=cnet.WN125;
    WN126=cnet.WN126;
    WN127=cnet.WN127;
    WN128=cnet.WN128;
    WN129=cnet.WN129;
    WN130=cnet.WN130;
    WN131=cnet.WN131;
    WN132=cnet.WN132;
    WN133=cnet.WN133;
    WN134=cnet.WN134;
    WN135=cnet.WN135;
    WN136=cnet.WN136;
    WN137=cnet.WN137;
    WN138=cnet.WN138;
    WN139=cnet.WN139;
    WN140=cnet.WN140;
    WN141=cnet.WN141;
    WN142=cnet.WN142;
    WN143=cnet.WN143;
    WN144=cnet.WN144;
    WN145=cnet.WN145;
    WN146=cnet.WN146;
    WN147=cnet.WN147;
    WN148=cnet.WN148;
    WN149=cnet.WN149;
    WN150=cnet.WN150;
    WN151=cnet.WN151;
    WN152=cnet.WN152;
    WN153=cnet.WN153;
    WN154=cnet.WN154;
    WN155=cnet.WN155;
    WN156=cnet.WN156;
    WN157=cnet.WN157;
    WN158=cnet.WN158;
    WN159=cnet.WN159;
    WN160=cnet.WN160;
    WN161=cnet.WN161;
    WN162=cnet.WN162;
    WN163=cnet.WN163;
    WN164=cnet.WN164;
    WN165=cnet.WN165;
    WN166=cnet.WN166;
    WN167=cnet.WN167;
    WN168=cnet.WN168;
    WN169=cnet.WN169;
    WN170=cnet.WN170;
    WN171=cnet.WN171;
    WN172=cnet.WN172;
    WN173=cnet.WN173;

    biasN001=cnet.biasN001;
    biasN002=cnet.biasN002;
    biasN003=cnet.biasN003;
    biasN004=cnet.biasN004;
    biasN005=cnet.biasN005;
    biasN006=cnet.biasN006;
    biasN007=cnet.biasN007;
    biasN008=cnet.biasN008;
    biasN009=cnet.biasN009;
    biasN010=cnet.biasN010;
    biasN011=cnet.biasN011;
    biasN012=cnet.biasN012;
    biasN013=cnet.biasN013;
    biasN014=cnet.biasN014;
    biasN015=cnet.biasN015;
    biasN016=cnet.biasN016;
    biasN017=cnet.biasN017;
    biasN018=cnet.biasN018;
    biasN019=cnet.biasN019;
    biasN020=cnet.biasN020;
    biasN021=cnet.biasN021;
    biasN022=cnet.biasN022;
    biasN023=cnet.biasN023;
    biasN024=cnet.biasN024;
    biasN025=cnet.biasN025;
    biasN026=cnet.biasN026;
    biasN027=cnet.biasN027;
    biasN028=cnet.biasN028;
    biasN029=cnet.biasN029;
    biasN030=cnet.biasN030;
    biasN031=cnet.biasN031;
    biasN032=cnet.biasN032;
    biasN033=cnet.biasN033;
    biasN034=cnet.biasN034;
    biasN035=cnet.biasN035;
    biasN036=cnet.biasN036;
    biasN037=cnet.biasN037;
    biasN038=cnet.biasN038;
    biasN039=cnet.biasN039;
    biasN040=cnet.biasN040;
    biasN041=cnet.biasN041;
    biasN042=cnet.biasN042;
    biasN043=cnet.biasN043;
    biasN044=cnet.biasN044;
    biasN045=cnet.biasN045;
    biasN046=cnet.biasN046;
    biasN047=cnet.biasN047;
    biasN048=cnet.biasN048;
    biasN049=cnet.biasN049;
    biasN050=cnet.biasN050;
    biasN051=cnet.biasN051;
    biasN052=cnet.biasN052;
    biasN053=cnet.biasN053;
    biasN054=cnet.biasN054;
    biasN055=cnet.biasN055;
    biasN056=cnet.biasN056;
    biasN057=cnet.biasN057;
    biasN058=cnet.biasN058;
    biasN059=cnet.biasN059;
    biasN060=cnet.biasN060;
    biasN061=cnet.biasN061;
    biasN062=cnet.biasN062;
    biasN063=cnet.biasN063;
    biasN064=cnet.biasN064;
    biasN065=cnet.biasN065;
    biasN066=cnet.biasN066;
    biasN067=cnet.biasN067;
    biasN068=cnet.biasN068;
    biasN069=cnet.biasN069;
    biasN070=cnet.biasN070;
    biasN071=cnet.biasN071;
    biasN072=cnet.biasN072;
    biasN073=cnet.biasN073;
    biasN074=cnet.biasN074;
    biasN075=cnet.biasN075;
    biasN076=cnet.biasN076;
    biasN077=cnet.biasN077;
    biasN078=cnet.biasN078;
    biasN079=cnet.biasN079;
    biasN080=cnet.biasN080;
    biasN081=cnet.biasN081;
    biasN082=cnet.biasN082;
    biasN083=cnet.biasN083;
    biasN084=cnet.biasN084;
    biasN085=cnet.biasN085;
    biasN086=cnet.biasN086;
    biasN087=cnet.biasN087;
    biasN088=cnet.biasN088;
    biasN089=cnet.biasN089;
    biasN090=cnet.biasN090;
    biasN091=cnet.biasN091;
    biasN092=cnet.biasN092;
    biasN093=cnet.biasN093;
    biasN094=cnet.biasN094;
    biasN095=cnet.biasN095;
    biasN096=cnet.biasN096;
    biasN097=cnet.biasN097;
    biasN098=cnet.biasN098;
    biasN099=cnet.biasN099;
    biasN100=cnet.biasN100;
    biasN101=cnet.biasN101;
    biasN102=cnet.biasN102;
    biasN103=cnet.biasN103;
    biasN104=cnet.biasN104;
    biasN105=cnet.biasN105;
    biasN106=cnet.biasN106;
    biasN107=cnet.biasN107;
    biasN108=cnet.biasN108;
    biasN109=cnet.biasN109;
    biasN110=cnet.biasN110;
    biasN111=cnet.biasN111;
    biasN112=cnet.biasN112;
    biasN113=cnet.biasN113;
    biasN114=cnet.biasN114;
    biasN115=cnet.biasN115;
    biasN116=cnet.biasN116;
    biasN117=cnet.biasN117;
    biasN118=cnet.biasN118;
    biasN119=cnet.biasN119;
    biasN120=cnet.biasN120;
    biasN121=cnet.biasN121;
    biasN122=cnet.biasN122;
    biasN123=cnet.biasN123;
    biasN124=cnet.biasN124;
    biasN125=cnet.biasN125;
    biasN126=cnet.biasN126;
    biasN127=cnet.biasN127;
    biasN128=cnet.biasN128;
    biasN129=cnet.biasN129;
    biasN130=cnet.biasN130;
    biasN131=cnet.biasN131;
    biasN132=cnet.biasN132;
    biasN133=cnet.biasN133;
    biasN134=cnet.biasN134;
    biasN135=cnet.biasN135;
    biasN136=cnet.biasN136;
    biasN137=cnet.biasN137;
    biasN138=cnet.biasN138;
    biasN139=cnet.biasN139;
    biasN140=cnet.biasN140;
    biasN141=cnet.biasN141;
    biasN142=cnet.biasN142;
    biasN143=cnet.biasN143;
    biasN144=cnet.biasN144;
    biasN145=cnet.biasN145;
    biasN146=cnet.biasN146;
    biasN147=cnet.biasN147;
    biasN148=cnet.biasN148;
    biasN149=cnet.biasN149;
    biasN150=cnet.biasN150;
    biasN151=cnet.biasN151;
    biasN152=cnet.biasN152;
    biasN153=cnet.biasN153;
    biasN154=cnet.biasN154;
    biasN155=cnet.biasN155;
    biasN156=cnet.biasN156;
    biasN157=cnet.biasN157;
    biasN158=cnet.biasN158;
    biasN159=cnet.biasN159;
    biasN160=cnet.biasN160;
    biasN161=cnet.biasN161;
    biasN162=cnet.biasN162;
    biasN163=cnet.biasN163;
    biasN164=cnet.biasN164;
    biasN165=cnet.biasN165;
    biasN166=cnet.biasN166;
    biasN167=cnet.biasN167;
    biasN168=cnet.biasN168;
    biasN169=cnet.biasN169;
    biasN170=cnet.biasN170;
    biasN171=cnet.biasN171;
    biasN172=cnet.biasN172;
    biasN173=cnet.biasN173;

    for i=1:20
        newWN001(:,:,i)=WN001(:,:,i)+p*errN(1)*yS2(:,:,i);
        newWN002(:,:,i)=WN002(:,:,i)+p*errN(2)*yS2(:,:,i);
        newWN003(:,:,i)=WN003(:,:,i)+p*errN(3)*yS2(:,:,i);
        newWN004(:,:,i)=WN004(:,:,i)+p*errN(4)*yS2(:,:,i);
        newWN005(:,:,i)=WN005(:,:,i)+p*errN(5)*yS2(:,:,i);
        newWN006(:,:,i)=WN006(:,:,i)+p*errN(6)*yS2(:,:,i);
        newWN007(:,:,i)=WN007(:,:,i)+p*errN(7)*yS2(:,:,i);
        newWN008(:,:,i)=WN008(:,:,i)+p*errN(8)*yS2(:,:,i);
        newWN009(:,:,i)=WN009(:,:,i)+p*errN(9)*yS2(:,:,i);
        newWN010(:,:,i)=WN010(:,:,i)+p*errN(10)*yS2(:,:,i);
        newWN011(:,:,i)=WN011(:,:,i)+p*errN(11)*yS2(:,:,i);
        newWN012(:,:,i)=WN012(:,:,i)+p*errN(12)*yS2(:,:,i);
        newWN013(:,:,i)=WN013(:,:,i)+p*errN(13)*yS2(:,:,i);
        newWN014(:,:,i)=WN014(:,:,i)+p*errN(14)*yS2(:,:,i);
        newWN015(:,:,i)=WN015(:,:,i)+p*errN(15)*yS2(:,:,i);
        newWN016(:,:,i)=WN016(:,:,i)+p*errN(16)*yS2(:,:,i);
        newWN017(:,:,i)=WN017(:,:,i)+p*errN(17)*yS2(:,:,i);
        newWN018(:,:,i)=WN018(:,:,i)+p*errN(18)*yS2(:,:,i);
        newWN019(:,:,i)=WN019(:,:,i)+p*errN(19)*yS2(:,:,i);
        newWN020(:,:,i)=WN020(:,:,i)+p*errN(20)*yS2(:,:,i);
        newWN021(:,:,i)=WN021(:,:,i)+p*errN(21)*yS2(:,:,i);
        newWN022(:,:,i)=WN022(:,:,i)+p*errN(22)*yS2(:,:,i);
        newWN023(:,:,i)=WN023(:,:,i)+p*errN(23)*yS2(:,:,i);
        newWN024(:,:,i)=WN024(:,:,i)+p*errN(24)*yS2(:,:,i);
        newWN025(:,:,i)=WN025(:,:,i)+p*errN(25)*yS2(:,:,i);
        newWN026(:,:,i)=WN026(:,:,i)+p*errN(26)*yS2(:,:,i);
        newWN027(:,:,i)=WN027(:,:,i)+p*errN(27)*yS2(:,:,i);
        newWN028(:,:,i)=WN028(:,:,i)+p*errN(28)*yS2(:,:,i);
        newWN029(:,:,i)=WN029(:,:,i)+p*errN(29)*yS2(:,:,i);
        newWN030(:,:,i)=WN030(:,:,i)+p*errN(30)*yS2(:,:,i);
        newWN031(:,:,i)=WN031(:,:,i)+p*errN(31)*yS2(:,:,i);
        newWN032(:,:,i)=WN032(:,:,i)+p*errN(32)*yS2(:,:,i);
        newWN033(:,:,i)=WN033(:,:,i)+p*errN(33)*yS2(:,:,i);
        newWN034(:,:,i)=WN034(:,:,i)+p*errN(34)*yS2(:,:,i);
        newWN035(:,:,i)=WN035(:,:,i)+p*errN(35)*yS2(:,:,i);
        newWN036(:,:,i)=WN036(:,:,i)+p*errN(36)*yS2(:,:,i);
        newWN037(:,:,i)=WN037(:,:,i)+p*errN(37)*yS2(:,:,i);
        newWN038(:,:,i)=WN038(:,:,i)+p*errN(38)*yS2(:,:,i);
        newWN039(:,:,i)=WN039(:,:,i)+p*errN(39)*yS2(:,:,i);
        newWN040(:,:,i)=WN040(:,:,i)+p*errN(40)*yS2(:,:,i);
        newWN041(:,:,i)=WN041(:,:,i)+p*errN(41)*yS2(:,:,i);
        newWN042(:,:,i)=WN042(:,:,i)+p*errN(42)*yS2(:,:,i);
        newWN043(:,:,i)=WN043(:,:,i)+p*errN(43)*yS2(:,:,i);
        newWN044(:,:,i)=WN044(:,:,i)+p*errN(44)*yS2(:,:,i);
        newWN045(:,:,i)=WN045(:,:,i)+p*errN(45)*yS2(:,:,i);
        newWN046(:,:,i)=WN046(:,:,i)+p*errN(46)*yS2(:,:,i);
        newWN047(:,:,i)=WN047(:,:,i)+p*errN(47)*yS2(:,:,i);
        newWN048(:,:,i)=WN048(:,:,i)+p*errN(48)*yS2(:,:,i);
        newWN049(:,:,i)=WN049(:,:,i)+p*errN(49)*yS2(:,:,i);
        newWN050(:,:,i)=WN050(:,:,i)+p*errN(50)*yS2(:,:,i);
        newWN051(:,:,i)=WN051(:,:,i)+p*errN(51)*yS2(:,:,i);
        newWN052(:,:,i)=WN052(:,:,i)+p*errN(52)*yS2(:,:,i);
        newWN053(:,:,i)=WN053(:,:,i)+p*errN(53)*yS2(:,:,i);
        newWN054(:,:,i)=WN054(:,:,i)+p*errN(54)*yS2(:,:,i);
        newWN055(:,:,i)=WN055(:,:,i)+p*errN(55)*yS2(:,:,i);
        newWN056(:,:,i)=WN056(:,:,i)+p*errN(56)*yS2(:,:,i);
        newWN057(:,:,i)=WN057(:,:,i)+p*errN(57)*yS2(:,:,i);
        newWN058(:,:,i)=WN058(:,:,i)+p*errN(58)*yS2(:,:,i);
        newWN059(:,:,i)=WN059(:,:,i)+p*errN(59)*yS2(:,:,i);
        newWN060(:,:,i)=WN060(:,:,i)+p*errN(60)*yS2(:,:,i);
        newWN061(:,:,i)=WN061(:,:,i)+p*errN(61)*yS2(:,:,i);
        newWN062(:,:,i)=WN062(:,:,i)+p*errN(62)*yS2(:,:,i);
        newWN063(:,:,i)=WN063(:,:,i)+p*errN(63)*yS2(:,:,i);
        newWN064(:,:,i)=WN064(:,:,i)+p*errN(64)*yS2(:,:,i);
        newWN065(:,:,i)=WN065(:,:,i)+p*errN(65)*yS2(:,:,i);
        newWN066(:,:,i)=WN066(:,:,i)+p*errN(66)*yS2(:,:,i);
        newWN067(:,:,i)=WN067(:,:,i)+p*errN(67)*yS2(:,:,i);
        newWN068(:,:,i)=WN068(:,:,i)+p*errN(68)*yS2(:,:,i);
        newWN069(:,:,i)=WN069(:,:,i)+p*errN(69)*yS2(:,:,i);
        newWN070(:,:,i)=WN070(:,:,i)+p*errN(70)*yS2(:,:,i);
        newWN071(:,:,i)=WN071(:,:,i)+p*errN(71)*yS2(:,:,i);
        newWN072(:,:,i)=WN072(:,:,i)+p*errN(72)*yS2(:,:,i);
        newWN073(:,:,i)=WN073(:,:,i)+p*errN(73)*yS2(:,:,i);
        newWN074(:,:,i)=WN074(:,:,i)+p*errN(74)*yS2(:,:,i);
        newWN075(:,:,i)=WN075(:,:,i)+p*errN(75)*yS2(:,:,i);
        newWN076(:,:,i)=WN076(:,:,i)+p*errN(76)*yS2(:,:,i);
        newWN077(:,:,i)=WN077(:,:,i)+p*errN(77)*yS2(:,:,i);
        newWN078(:,:,i)=WN078(:,:,i)+p*errN(78)*yS2(:,:,i);
        newWN079(:,:,i)=WN079(:,:,i)+p*errN(79)*yS2(:,:,i);
        newWN080(:,:,i)=WN080(:,:,i)+p*errN(80)*yS2(:,:,i);
        newWN081(:,:,i)=WN081(:,:,i)+p*errN(81)*yS2(:,:,i);
        newWN082(:,:,i)=WN082(:,:,i)+p*errN(82)*yS2(:,:,i);
        newWN083(:,:,i)=WN083(:,:,i)+p*errN(83)*yS2(:,:,i);
        newWN084(:,:,i)=WN084(:,:,i)+p*errN(84)*yS2(:,:,i);
        newWN085(:,:,i)=WN085(:,:,i)+p*errN(85)*yS2(:,:,i);
        newWN086(:,:,i)=WN086(:,:,i)+p*errN(86)*yS2(:,:,i);
        newWN087(:,:,i)=WN087(:,:,i)+p*errN(87)*yS2(:,:,i);
        newWN088(:,:,i)=WN088(:,:,i)+p*errN(88)*yS2(:,:,i);
        newWN089(:,:,i)=WN089(:,:,i)+p*errN(89)*yS2(:,:,i);
        newWN090(:,:,i)=WN090(:,:,i)+p*errN(90)*yS2(:,:,i);
        newWN091(:,:,i)=WN091(:,:,i)+p*errN(91)*yS2(:,:,i);
        newWN092(:,:,i)=WN092(:,:,i)+p*errN(92)*yS2(:,:,i);
        newWN093(:,:,i)=WN093(:,:,i)+p*errN(93)*yS2(:,:,i);
        newWN094(:,:,i)=WN094(:,:,i)+p*errN(94)*yS2(:,:,i);
        newWN095(:,:,i)=WN095(:,:,i)+p*errN(95)*yS2(:,:,i);
        newWN096(:,:,i)=WN096(:,:,i)+p*errN(96)*yS2(:,:,i);
        newWN097(:,:,i)=WN097(:,:,i)+p*errN(97)*yS2(:,:,i);
        newWN098(:,:,i)=WN098(:,:,i)+p*errN(98)*yS2(:,:,i);
        newWN099(:,:,i)=WN099(:,:,i)+p*errN(99)*yS2(:,:,i);
        newWN100(:,:,i)=WN100(:,:,i)+p*errN(100)*yS2(:,:,i);
        newWN101(:,:,i)=WN101(:,:,i)+p*errN(101)*yS2(:,:,i);
        newWN102(:,:,i)=WN102(:,:,i)+p*errN(102)*yS2(:,:,i);
        newWN103(:,:,i)=WN103(:,:,i)+p*errN(103)*yS2(:,:,i);
        newWN104(:,:,i)=WN104(:,:,i)+p*errN(104)*yS2(:,:,i);
        newWN105(:,:,i)=WN105(:,:,i)+p*errN(105)*yS2(:,:,i);
        newWN106(:,:,i)=WN106(:,:,i)+p*errN(106)*yS2(:,:,i);
        newWN107(:,:,i)=WN107(:,:,i)+p*errN(107)*yS2(:,:,i);
        newWN108(:,:,i)=WN108(:,:,i)+p*errN(108)*yS2(:,:,i);
        newWN109(:,:,i)=WN109(:,:,i)+p*errN(119)*yS2(:,:,i);
        newWN110(:,:,i)=WN110(:,:,i)+p*errN(110)*yS2(:,:,i);
        newWN111(:,:,i)=WN111(:,:,i)+p*errN(111)*yS2(:,:,i);
        newWN112(:,:,i)=WN112(:,:,i)+p*errN(112)*yS2(:,:,i);
        newWN113(:,:,i)=WN113(:,:,i)+p*errN(113)*yS2(:,:,i);
        newWN114(:,:,i)=WN114(:,:,i)+p*errN(114)*yS2(:,:,i);
        newWN115(:,:,i)=WN115(:,:,i)+p*errN(115)*yS2(:,:,i);
        newWN116(:,:,i)=WN116(:,:,i)+p*errN(116)*yS2(:,:,i);
        newWN117(:,:,i)=WN117(:,:,i)+p*errN(117)*yS2(:,:,i);
        newWN118(:,:,i)=WN118(:,:,i)+p*errN(118)*yS2(:,:,i);
        newWN119(:,:,i)=WN119(:,:,i)+p*errN(119)*yS2(:,:,i);
        newWN120(:,:,i)=WN120(:,:,i)+p*errN(120)*yS2(:,:,i);
        newWN121(:,:,i)=WN121(:,:,i)+p*errN(121)*yS2(:,:,i);
        newWN122(:,:,i)=WN122(:,:,i)+p*errN(122)*yS2(:,:,i);
        newWN123(:,:,i)=WN123(:,:,i)+p*errN(123)*yS2(:,:,i);
        newWN124(:,:,i)=WN124(:,:,i)+p*errN(124)*yS2(:,:,i);
        newWN125(:,:,i)=WN125(:,:,i)+p*errN(125)*yS2(:,:,i);
        newWN126(:,:,i)=WN126(:,:,i)+p*errN(126)*yS2(:,:,i);
        newWN127(:,:,i)=WN127(:,:,i)+p*errN(127)*yS2(:,:,i);
        newWN128(:,:,i)=WN128(:,:,i)+p*errN(128)*yS2(:,:,i);
        newWN129(:,:,i)=WN129(:,:,i)+p*errN(129)*yS2(:,:,i);
        newWN130(:,:,i)=WN130(:,:,i)+p*errN(130)*yS2(:,:,i);
        newWN131(:,:,i)=WN131(:,:,i)+p*errN(131)*yS2(:,:,i);
        newWN132(:,:,i)=WN132(:,:,i)+p*errN(132)*yS2(:,:,i);
        newWN133(:,:,i)=WN133(:,:,i)+p*errN(133)*yS2(:,:,i);
        newWN134(:,:,i)=WN134(:,:,i)+p*errN(134)*yS2(:,:,i);
        newWN135(:,:,i)=WN135(:,:,i)+p*errN(135)*yS2(:,:,i);
        newWN136(:,:,i)=WN136(:,:,i)+p*errN(135)*yS2(:,:,i);
        newWN137(:,:,i)=WN137(:,:,i)+p*errN(136)*yS2(:,:,i);
        newWN138(:,:,i)=WN138(:,:,i)+p*errN(138)*yS2(:,:,i);
        newWN139(:,:,i)=WN139(:,:,i)+p*errN(139)*yS2(:,:,i);
        newWN140(:,:,i)=WN140(:,:,i)+p*errN(140)*yS2(:,:,i);
        newWN141(:,:,i)=WN141(:,:,i)+p*errN(141)*yS2(:,:,i);
        newWN142(:,:,i)=WN142(:,:,i)+p*errN(142)*yS2(:,:,i);
        newWN143(:,:,i)=WN143(:,:,i)+p*errN(143)*yS2(:,:,i);
        newWN144(:,:,i)=WN144(:,:,i)+p*errN(144)*yS2(:,:,i);
        newWN145(:,:,i)=WN145(:,:,i)+p*errN(145)*yS2(:,:,i);
        newWN146(:,:,i)=WN146(:,:,i)+p*errN(146)*yS2(:,:,i);
        newWN147(:,:,i)=WN147(:,:,i)+p*errN(147)*yS2(:,:,i);
        newWN148(:,:,i)=WN148(:,:,i)+p*errN(148)*yS2(:,:,i);
        newWN149(:,:,i)=WN149(:,:,i)+p*errN(149)*yS2(:,:,i);
        newWN150(:,:,i)=WN150(:,:,i)+p*errN(150)*yS2(:,:,i);
        newWN151(:,:,i)=WN151(:,:,i)+p*errN(151)*yS2(:,:,i);
        newWN152(:,:,i)=WN152(:,:,i)+p*errN(152)*yS2(:,:,i);
        newWN153(:,:,i)=WN153(:,:,i)+p*errN(153)*yS2(:,:,i);
        newWN154(:,:,i)=WN154(:,:,i)+p*errN(154)*yS2(:,:,i);
        newWN155(:,:,i)=WN155(:,:,i)+p*errN(155)*yS2(:,:,i);
        newWN156(:,:,i)=WN156(:,:,i)+p*errN(156)*yS2(:,:,i);
        newWN157(:,:,i)=WN157(:,:,i)+p*errN(157)*yS2(:,:,i);
        newWN158(:,:,i)=WN158(:,:,i)+p*errN(158)*yS2(:,:,i);
        newWN159(:,:,i)=WN159(:,:,i)+p*errN(159)*yS2(:,:,i);
        newWN160(:,:,i)=WN160(:,:,i)+p*errN(160)*yS2(:,:,i);
        newWN161(:,:,i)=WN161(:,:,i)+p*errN(161)*yS2(:,:,i);
        newWN162(:,:,i)=WN162(:,:,i)+p*errN(162)*yS2(:,:,i);
        newWN163(:,:,i)=WN163(:,:,i)+p*errN(163)*yS2(:,:,i);
        newWN164(:,:,i)=WN164(:,:,i)+p*errN(164)*yS2(:,:,i);
        newWN165(:,:,i)=WN165(:,:,i)+p*errN(165)*yS2(:,:,i);
        newWN166(:,:,i)=WN166(:,:,i)+p*errN(166)*yS2(:,:,i);
        newWN167(:,:,i)=WN167(:,:,i)+p*errN(167)*yS2(:,:,i);
        newWN168(:,:,i)=WN168(:,:,i)+p*errN(168)*yS2(:,:,i);
        newWN169(:,:,i)=WN169(:,:,i)+p*errN(169)*yS2(:,:,i);
        newWN170(:,:,i)=WN170(:,:,i)+p*errN(170)*yS2(:,:,i);
        newWN171(:,:,i)=WN171(:,:,i)+p*errN(171)*yS2(:,:,i);
        newWN172(:,:,i)=WN172(:,:,i)+p*errN(172)*yS2(:,:,i);
        newWN173(:,:,i)=WN173(:,:,i)+p*errN(173)*yS2(:,:,i);
    end

    newbiasN001=biasN001+p*errN(1);
    newbiasN002=biasN002+p*errN(2);
    newbiasN003=biasN003+p*errN(3);
    newbiasN004=biasN004+p*errN(4);
    newbiasN005=biasN005+p*errN(5);
    newbiasN006=biasN006+p*errN(6);
    newbiasN007=biasN007+p*errN(7);
    newbiasN008=biasN008+p*errN(8);
    newbiasN009=biasN009+p*errN(9);
    newbiasN010=biasN010+p*errN(10);
    newbiasN011=biasN011+p*errN(11);
    newbiasN012=biasN012+p*errN(12);
    newbiasN013=biasN013+p*errN(13);
    newbiasN014=biasN014+p*errN(14);
    newbiasN015=biasN015+p*errN(15);
    newbiasN016=biasN016+p*errN(16);
    newbiasN017=biasN017+p*errN(17);
    newbiasN018=biasN018+p*errN(18);
    newbiasN019=biasN019+p*errN(19);
    newbiasN020=biasN020+p*errN(20);
    newbiasN021=biasN021+p*errN(21);
    newbiasN022=biasN022+p*errN(22);
    newbiasN023=biasN023+p*errN(23);
    newbiasN024=biasN024+p*errN(24);
    newbiasN025=biasN025+p*errN(25);
    newbiasN026=biasN026+p*errN(26);
    newbiasN027=biasN027+p*errN(27);
    newbiasN028=biasN028+p*errN(28);
    newbiasN029=biasN029+p*errN(29);
    newbiasN030=biasN030+p*errN(30);
    newbiasN031=biasN031+p*errN(31);
    newbiasN032=biasN032+p*errN(32);
    newbiasN033=biasN033+p*errN(33);
    newbiasN034=biasN034+p*errN(34);
    newbiasN035=biasN035+p*errN(35);
    newbiasN036=biasN036+p*errN(36);
    newbiasN037=biasN037+p*errN(37);
    newbiasN038=biasN038+p*errN(38);
    newbiasN039=biasN039+p*errN(39);
    newbiasN040=biasN040+p*errN(40);
    newbiasN041=biasN041+p*errN(41);
    newbiasN042=biasN042+p*errN(42);
    newbiasN043=biasN043+p*errN(43);
    newbiasN044=biasN044+p*errN(44);
    newbiasN045=biasN045+p*errN(45);
    newbiasN046=biasN046+p*errN(46);
    newbiasN047=biasN047+p*errN(47);
    newbiasN048=biasN048+p*errN(48);
    newbiasN049=biasN049+p*errN(49);
    newbiasN050=biasN050+p*errN(50);
    newbiasN051=biasN051+p*errN(51);
    newbiasN052=biasN052+p*errN(52);
    newbiasN053=biasN053+p*errN(53);
    newbiasN054=biasN054+p*errN(54);
    newbiasN055=biasN055+p*errN(55);
    newbiasN056=biasN056+p*errN(56);
    newbiasN057=biasN057+p*errN(57);
    newbiasN058=biasN058+p*errN(58);
    newbiasN059=biasN059+p*errN(59);
    newbiasN060=biasN060+p*errN(60);
    newbiasN061=biasN061+p*errN(61);
    newbiasN062=biasN062+p*errN(62);
    newbiasN063=biasN063+p*errN(63);
    newbiasN064=biasN064+p*errN(64);
    newbiasN065=biasN065+p*errN(65);
    newbiasN066=biasN066+p*errN(66);
    newbiasN067=biasN067+p*errN(67);
    newbiasN068=biasN068+p*errN(68);
    newbiasN069=biasN069+p*errN(69);
    newbiasN070=biasN070+p*errN(70);
    newbiasN071=biasN071+p*errN(71);
    newbiasN072=biasN072+p*errN(72);
    newbiasN073=biasN073+p*errN(73);
    newbiasN074=biasN074+p*errN(74);
    newbiasN075=biasN075+p*errN(75);
    newbiasN076=biasN076+p*errN(76);
    newbiasN077=biasN077+p*errN(77);
    newbiasN078=biasN078+p*errN(78);
    newbiasN079=biasN079+p*errN(79);
    newbiasN080=biasN080+p*errN(80);
    newbiasN081=biasN081+p*errN(81);
    newbiasN082=biasN082+p*errN(82);
    newbiasN083=biasN083+p*errN(83);
    newbiasN084=biasN084+p*errN(84);
    newbiasN085=biasN085+p*errN(85);
    newbiasN086=biasN086+p*errN(86);
    newbiasN087=biasN087+p*errN(87);
    newbiasN088=biasN088+p*errN(88);
    newbiasN089=biasN089+p*errN(89);
    newbiasN090=biasN090+p*errN(90);
    newbiasN091=biasN091+p*errN(91);
    newbiasN092=biasN092+p*errN(92);
    newbiasN093=biasN093+p*errN(93);
    newbiasN094=biasN094+p*errN(94);
    newbiasN095=biasN095+p*errN(95);
    newbiasN096=biasN096+p*errN(96);
    newbiasN097=biasN097+p*errN(97);
    newbiasN098=biasN098+p*errN(98);
    newbiasN099=biasN099+p*errN(99);
    newbiasN100=biasN100+p*errN(100);
    newbiasN101=biasN101+p*errN(101);
    newbiasN102=biasN102+p*errN(102);
    newbiasN103=biasN103+p*errN(103);
    newbiasN104=biasN104+p*errN(104);
    newbiasN105=biasN105+p*errN(105);
    newbiasN106=biasN106+p*errN(106);
    newbiasN107=biasN107+p*errN(107);
    newbiasN108=biasN108+p*errN(108);
    newbiasN109=biasN109+p*errN(119);
    newbiasN110=biasN110+p*errN(110);
    newbiasN111=biasN111+p*errN(111);
    newbiasN112=biasN112+p*errN(112);
    newbiasN113=biasN113+p*errN(113);
    newbiasN114=biasN114+p*errN(114);
    newbiasN115=biasN115+p*errN(115);
    newbiasN116=biasN116+p*errN(116);
    newbiasN117=biasN117+p*errN(117);
    newbiasN118=biasN118+p*errN(118);
    newbiasN119=biasN119+p*errN(119);
    newbiasN120=biasN120+p*errN(120);
    newbiasN121=biasN121+p*errN(121);
    newbiasN122=biasN122+p*errN(122);
    newbiasN123=biasN123+p*errN(123);
    newbiasN124=biasN124+p*errN(124);
    newbiasN125=biasN125+p*errN(125);
    newbiasN126=biasN126+p*errN(126);
    newbiasN127=biasN127+p*errN(127);
    newbiasN128=biasN128+p*errN(128);
    newbiasN129=biasN129+p*errN(129);
    newbiasN130=biasN130+p*errN(130);
    newbiasN131=biasN131+p*errN(131);
    newbiasN132=biasN132+p*errN(132);
    newbiasN133=biasN133+p*errN(133);
    newbiasN134=biasN134+p*errN(134);
    newbiasN135=biasN135+p*errN(135);
    newbiasN136=biasN136+p*errN(136);
    newbiasN137=biasN137+p*errN(137);
    newbiasN138=biasN138+p*errN(138);
    newbiasN139=biasN139+p*errN(139);
    newbiasN140=biasN140+p*errN(140);
    newbiasN141=biasN141+p*errN(141);
    newbiasN142=biasN142+p*errN(142);
    newbiasN143=biasN143+p*errN(143);
    newbiasN144=biasN144+p*errN(144);
    newbiasN145=biasN145+p*errN(145);
    newbiasN146=biasN146+p*errN(146);
    newbiasN147=biasN147+p*errN(147);
    newbiasN148=biasN148+p*errN(148);
    newbiasN149=biasN149+p*errN(149);
    newbiasN150=biasN150+p*errN(150);
    newbiasN151=biasN151+p*errN(151);
    newbiasN152=biasN152+p*errN(152);
    newbiasN153=biasN153+p*errN(153);
    newbiasN154=biasN154+p*errN(154);
    newbiasN155=biasN155+p*errN(155);
    newbiasN156=biasN156+p*errN(156);
    newbiasN157=biasN157+p*errN(157);
    newbiasN158=biasN158+p*errN(158);
    newbiasN159=biasN159+p*errN(159);
    newbiasN160=biasN160+p*errN(160);
    newbiasN161=biasN161+p*errN(161);
    newbiasN162=biasN162+p*errN(162);
    newbiasN163=biasN163+p*errN(163);
    newbiasN164=biasN164+p*errN(164);
    newbiasN165=biasN165+p*errN(165);
    newbiasN166=biasN166+p*errN(166);
    newbiasN167=biasN167+p*errN(167);
    newbiasN168=biasN168+p*errN(168);
    newbiasN169=biasN169+p*errN(169);
    newbiasN170=biasN170+p*errN(170);
    newbiasN171=biasN171+p*errN(171);
    newbiasN172=biasN172+p*errN(172);
    newbiasN173=biasN173+p*errN(173);

    %%
    % Layer S2
    WS2C201=cnet.WS2C201;
    WS2C202=cnet.WS2C202;
    WS2C203=cnet.WS2C203;
    WS2C204=cnet.WS2C204;
    WS2C205=cnet.WS2C205;
    WS2C206=cnet.WS2C206;
    WS2C207=cnet.WS2C207;
    WS2C208=cnet.WS2C208;
    WS2C209=cnet.WS2C209;
    WS2C210=cnet.WS2C210;
    WS2C211=cnet.WS2C211;
    WS2C212=cnet.WS2C212;
    WS2C213=cnet.WS2C213;
    WS2C214=cnet.WS2C214;
    WS2C215=cnet.WS2C215;
    WS2C216=cnet.WS2C216;
    WS2C217=cnet.WS2C217;
    WS2C218=cnet.WS2C218;
    WS2C219=cnet.WS2C219;
    WS2C220=cnet.WS2C220;

    biasS201=cnet.biasS201;
    biasS202=cnet.biasS202;
    biasS203=cnet.biasS203;
    biasS204=cnet.biasS204;
    biasS205=cnet.biasS205;
    biasS206=cnet.biasS206;
    biasS207=cnet.biasS207;
    biasS208=cnet.biasS208;
    biasS209=cnet.biasS209;
    biasS210=cnet.biasS210;
    biasS211=cnet.biasS211;
    biasS212=cnet.biasS212;
    biasS213=cnet.biasS213;
    biasS214=cnet.biasS214;
    biasS215=cnet.biasS215;
    biasS216=cnet.biasS216;
    biasS217=cnet.biasS217;
    biasS218=cnet.biasS218;
    biasS219=cnet.biasS219;
    biasS220=cnet.biasS220;

    errS201=errS2(:,:,1);
    errS202=errS2(:,:,2);
    errS203=errS2(:,:,3);
    errS204=errS2(:,:,4);
    errS205=errS2(:,:,5);
    errS206=errS2(:,:,6);
    errS207=errS2(:,:,7);
    errS208=errS2(:,:,8);
    errS209=errS2(:,:,9);
    errS210=errS2(:,:,10);
    errS211=errS2(:,:,11);
    errS212=errS2(:,:,12);
    errS213=errS2(:,:,13);
    errS214=errS2(:,:,14);
    errS215=errS2(:,:,15);
    errS216=errS2(:,:,16);
    errS217=errS2(:,:,17);
    errS218=errS2(:,:,18);
    errS219=errS2(:,:,19);
    errS220=errS2(:,:,20);

    for i=1:6
        i1=2*i-1;
        i2=2*i;
        for j=1:6
            j1=2*j-1;
            j2=2*j;
            y1(i,j)=sum(sum(yC2(i1:i2,j1:j2,1)))/4;
            y2(i,j)=sum(sum(yC2(i1:i2,j1:j2,2)))/4;
            y3(i,j)=sum(sum(yC2(i1:i2,j1:j2,3)))/4;
            y4(i,j)=sum(sum(yC2(i1:i2,j1:j2,4)))/4;
            y5(i,j)=sum(sum(yC2(i1:i2,j1:j2,5)))/4;
            y6(i,j)=sum(sum(yC2(i1:i2,j1:j2,6)))/4;
            y7(i,j)=sum(sum(yC2(i1:i2,j1:j2,7)))/4;
            y8(i,j)=sum(sum(yC2(i1:i2,j1:j2,8)))/4;
            y9(i,j)=sum(sum(yC2(i1:i2,j1:j2,9)))/4;
            y10(i,j)=sum(sum(yC2(i1:i2,j1:j2,10)))/4;
            y11(i,j)=sum(sum(yC2(i1:i2,j1:j2,11)))/4;
            y12(i,j)=sum(sum(yC2(i1:i2,j1:j2,12)))/4;
            y13(i,j)=sum(sum(yC2(i1:i2,j1:j2,13)))/4;
            y14(i,j)=sum(sum(yC2(i1:i2,j1:j2,14)))/4;
            y15(i,j)=sum(sum(yC2(i1:i2,j1:j2,15)))/4;
            y16(i,j)=sum(sum(yC2(i1:i2,j1:j2,16)))/4;
            y17(i,j)=sum(sum(yC2(i1:i2,j1:j2,17)))/4;
            y18(i,j)=sum(sum(yC2(i1:i2,j1:j2,18)))/4;
            y19(i,j)=sum(sum(yC2(i1:i2,j1:j2,19)))/4;
            y20(i,j)=sum(sum(yC2(i1:i2,j1:j2,20)))/4;
        end
    end

    newWS2C201=WS2C201+p*errS201.*y1;
    newWS2C202=WS2C202+p*errS202.*y2;
    newWS2C203=WS2C203+p*errS203.*y3;
    newWS2C204=WS2C204+p*errS204.*y4;
    newWS2C205=WS2C205+p*errS205.*y5;
    newWS2C206=WS2C206+p*errS206.*y6;
    newWS2C207=WS2C207+p*errS207.*y7;
    newWS2C208=WS2C208+p*errS208.*y8;
    newWS2C209=WS2C209+p*errS209.*y9;
    newWS2C210=WS2C210+p*errS210.*y10;
    newWS2C211=WS2C211+p*errS211.*y11;
    newWS2C212=WS2C212+p*errS212.*y12;
    newWS2C213=WS2C213+p*errS213.*y13;
    newWS2C214=WS2C214+p*errS214.*y14;
    newWS2C215=WS2C215+p*errS215.*y15;
    newWS2C216=WS2C216+p*errS216.*y16;
    newWS2C217=WS2C217+p*errS217.*y17;
    newWS2C218=WS2C218+p*errS218.*y18;
    newWS2C219=WS2C219+p*errS219.*y19;
    newWS2C220=WS2C220+p*errS220.*y20;

    newbiasS201=biasS201+p*errS201;
    newbiasS202=biasS202+p*errS202;
    newbiasS203=biasS203+p*errS203;
    newbiasS204=biasS204+p*errS204;
    newbiasS205=biasS205+p*errS205;
    newbiasS206=biasS206+p*errS206;
    newbiasS207=biasS207+p*errS207;
    newbiasS208=biasS208+p*errS208;
    newbiasS209=biasS209+p*errS209;
    newbiasS210=biasS210+p*errS210;
    newbiasS211=biasS211+p*errS211;
    newbiasS212=biasS212+p*errS212;
    newbiasS213=biasS213+p*errS213;
    newbiasS214=biasS214+p*errS214;
    newbiasS215=biasS215+p*errS215;
    newbiasS216=biasS216+p*errS216;
    newbiasS217=biasS217+p*errS217;
    newbiasS218=biasS218+p*errS218;
    newbiasS219=biasS219+p*errS219;
    newbiasS220=biasS220+p*errS220;

    %%
    % Layer C2
    WC201_01=cnet.WC201_01;
    WC201_02=cnet.WC201_02;
    WC201_03=cnet.WC201_03;

    WC202_01=cnet.WC202_01;
    WC202_03=cnet.WC202_03;
    WC202_04=cnet.WC202_04;

    WC203_01=cnet.WC203_01;
    WC203_04=cnet.WC203_04;
    WC203_05=cnet.WC203_05;

    WC204_01=cnet.WC204_01;
    WC204_05=cnet.WC204_05;
    WC204_06=cnet.WC204_06;

    WC205_01=cnet.WC205_01;
    WC205_06=cnet.WC205_06;
    WC205_07=cnet.WC205_07;

    WC206_01=cnet.WC206_01;
    WC206_07=cnet.WC206_07;
    WC206_08=cnet.WC206_08;

    WC207_01=cnet.WC207_01;
    WC207_08=cnet.WC207_08;

    WC208_02=cnet.WC208_02;
    WC208_03=cnet.WC208_03;
    WC208_04=cnet.WC208_04;

    WC209_02=cnet.WC209_02;
    WC209_04=cnet.WC209_04;
    WC209_05=cnet.WC209_05;

    WC210_02=cnet.WC210_02;
    WC210_05=cnet.WC210_05;
    WC210_06=cnet.WC210_06;
    
    WC211_02=cnet.WC211_02;
    WC211_06=cnet.WC211_06;
    WC211_07=cnet.WC211_07;
    
    WC212_02=cnet.WC212_02;
    WC212_07=cnet.WC212_07;
    WC212_08=cnet.WC212_08;
    
    WC213_02=cnet.WC213_02;
    WC213_08=cnet.WC213_08;
    
    WC214_03=cnet.WC214_03;
    WC214_04=cnet.WC214_04;
    WC214_05=cnet.WC214_05;

    WC215_03=cnet.WC215_03;
    WC215_05=cnet.WC215_05;
    WC215_06=cnet.WC215_06;
    
    WC216_03=cnet.WC216_03;
    WC216_06=cnet.WC216_06;
    WC216_07=cnet.WC216_07;
    
    WC217_03=cnet.WC217_03;
    WC217_07=cnet.WC217_07;
    WC217_08=cnet.WC217_08;
    
    WC218_03=cnet.WC218_03;
    WC218_08=cnet.WC218_08;
    
    WC219_04=cnet.WC219_04;
    WC219_05=cnet.WC219_05;
    WC219_06=cnet.WC219_06;
    
    WC220_04=cnet.WC220_04;
    WC220_06=cnet.WC220_06;
    WC220_07=cnet.WC220_07;

    biasC201=cnet.biasC201;
    biasC202=cnet.biasC202;
    biasC203=cnet.biasC203;
    biasC204=cnet.biasC204;
    biasC205=cnet.biasC205;
    biasC206=cnet.biasC206;
    biasC207=cnet.biasC207;
    biasC208=cnet.biasC208;
    biasC209=cnet.biasC209;
    biasC210=cnet.biasC210;
    biasC211=cnet.biasC211;
    biasC212=cnet.biasC212;
    biasC213=cnet.biasC213;
    biasC214=cnet.biasC214;
    biasC215=cnet.biasC215;
    biasC216=cnet.biasC216;
    biasC217=cnet.biasC217;
    biasC218=cnet.biasC218;
    biasC219=cnet.biasC219;
    biasC220=cnet.biasC220;

    errC201=errC2(:,:,1);
    errC202=errC2(:,:,2);
    errC203=errC2(:,:,3);
    errC204=errC2(:,:,4);
    errC205=errC2(:,:,5);
    errC206=errC2(:,:,6);
    errC207=errC2(:,:,7);
    errC208=errC2(:,:,8);
    errC209=errC2(:,:,9);
    errC210=errC2(:,:,10);
    errC211=errC2(:,:,11);
    errC212=errC2(:,:,12);
    errC213=errC2(:,:,13);
    errC214=errC2(:,:,14);
    errC215=errC2(:,:,15);
    errC216=errC2(:,:,16);
    errC217=errC2(:,:,17);
    errC218=errC2(:,:,18);
    errC219=errC2(:,:,19);
    errC220=errC2(:,:,20);

    yS101=yS1(:,:,1);
    yS102=yS1(:,:,2);
    yS103=yS1(:,:,3);
    yS104=yS1(:,:,4);
    yS105=yS1(:,:,5);
    yS106=yS1(:,:,6);
    yS107=yS1(:,:,7);
    yS108=yS1(:,:,8);

    for i=1:12
        for j=1:12
            y101(:,i,j)=reshape(yS101(i:i+4,j:j+4),1,[]);
            y102(:,i,j)=reshape(yS102(i:i+4,j:j+4),1,[]);
            y103(:,i,j)=reshape(yS103(i:i+4,j:j+4),1,[]);
            y104(:,i,j)=reshape(yS104(i:i+4,j:j+4),1,[]);
            y105(:,i,j)=reshape(yS105(i:i+4,j:j+4),1,[]);
            y106(:,i,j)=reshape(yS106(i:i+4,j:j+4),1,[]);
            y107(:,i,j)=reshape(yS107(i:i+4,j:j+4),1,[]);
            y108(:,i,j)=reshape(yS108(i:i+4,j:j+4),1,[]);
        end
    end

    for i=1:25
        %C201
        temp=reshape(WC201_01(i,:,:),12,12)+p*errC201.*reshape(y101(i,:,:),12,12);
        newWC201_01(i,:,:)=temp;
        temp=reshape(WC201_02(i,:,:),12,12)+p*errC201.*reshape(y102(i,:,:),12,12);
        newWC201_02(i,:,:)=temp;
        temp=reshape(WC201_03(i,:,:),12,12)+p*errC201.*reshape(y103(i,:,:),12,12);
        newWC201_03(i,:,:)=temp;
        
        %C202
        temp=reshape(WC202_01(i,:,:),12,12)+p*errC202.*reshape(y101(i,:,:),12,12);
        newWC202_01(i,:,:)=temp;
        temp=reshape(WC202_03(i,:,:),12,12)+p*errC202.*reshape(y103(i,:,:),12,12);
        newWC202_03(i,:,:)=temp;
        temp=reshape(WC202_04(i,:,:),12,12)+p*errC202.*reshape(y104(i,:,:),12,12);
        newWC202_04(i,:,:)=temp;

        %C203
        temp=reshape(WC203_01(i,:,:),12,12)+p*errC203.*reshape(y101(i,:,:),12,12);
        newWC203_01(i,:,:)=temp;
        temp=reshape(WC203_04(i,:,:),12,12)+p*errC203.*reshape(y104(i,:,:),12,12);
        newWC203_04(i,:,:)=temp;
        temp=reshape(WC203_05(i,:,:),12,12)+p*errC203.*reshape(y105(i,:,:),12,12);
        newWC203_05(i,:,:)=temp;
        
        %C204
        temp=reshape(WC204_01(i,:,:),12,12)+p*errC204.*reshape(y101(i,:,:),12,12);
        newWC204_01(i,:,:)=temp;
        temp=reshape(WC204_05(i,:,:),12,12)+p*errC204.*reshape(y105(i,:,:),12,12);
        newWC204_05(i,:,:)=temp;
        temp=reshape(WC204_06(i,:,:),12,12)+p*errC204.*reshape(y106(i,:,:),12,12);
        newWC204_06(i,:,:)=temp;

        %C205
        temp=reshape(WC205_01(i,:,:),12,12)+p*errC205.*reshape(y101(i,:,:),12,12);
        newWC205_01(i,:,:)=temp;
        temp=reshape(WC205_06(i,:,:),12,12)+p*errC205.*reshape(y106(i,:,:),12,12);
        newWC205_06(i,:,:)=temp;
        temp=reshape(WC205_07(i,:,:),12,12)+p*errC205.*reshape(y107(i,:,:),12,12);
        newWC205_07(i,:,:)=temp;

        %C206
        temp=reshape(WC206_01(i,:,:),12,12)+p*errC206.*reshape(y101(i,:,:),12,12);
        newWC206_01(i,:,:)=temp;
        temp=reshape(WC206_07(i,:,:),12,12)+p*errC206.*reshape(y107(i,:,:),12,12);
        newWC206_07(i,:,:)=temp;
        temp=reshape(WC206_08(i,:,:),12,12)+p*errC206.*reshape(y108(i,:,:),12,12);
        newWC206_08(i,:,:)=temp;

        %C207
        temp=reshape(WC207_01(i,:,:),12,12)+p*errC207.*reshape(y101(i,:,:),12,12);
        newWC207_01(i,:,:)=temp;
        temp=reshape(WC207_08(i,:,:),12,12)+p*errC207.*reshape(y108(i,:,:),12,12);
        newWC207_08(i,:,:)=temp;

        %C208
        temp=reshape(WC208_02(i,:,:),12,12)+p*errC208.*reshape(y102(i,:,:),12,12);
        newWC208_02(i,:,:)=temp;
        temp=reshape(WC208_03(i,:,:),12,12)+p*errC208.*reshape(y103(i,:,:),12,12);
        newWC208_03(i,:,:)=temp;
        temp=reshape(WC208_04(i,:,:),12,12)+p*errC208.*reshape(y104(i,:,:),12,12);
        newWC208_04(i,:,:)=temp;

        %C209
        temp=reshape(WC209_02(i,:,:),12,12)+p*errC209.*reshape(y102(i,:,:),12,12);
        newWC209_02(i,:,:)=temp;
        temp=reshape(WC209_04(i,:,:),12,12)+p*errC209.*reshape(y104(i,:,:),12,12);
        newWC209_04(i,:,:)=temp;
        temp=reshape(WC209_05(i,:,:),12,12)+p*errC209.*reshape(y105(i,:,:),12,12);
        newWC209_05(i,:,:)=temp;

        %C210
        temp=reshape(WC210_02(i,:,:),12,12)+p*errC210.*reshape(y102(i,:,:),12,12);
        newWC210_02(i,:,:)=temp;
        temp=reshape(WC210_05(i,:,:),12,12)+p*errC210.*reshape(y105(i,:,:),12,12);
        newWC210_05(i,:,:)=temp;
        temp=reshape(WC210_06(i,:,:),12,12)+p*errC210.*reshape(y106(i,:,:),12,12);
        newWC210_06(i,:,:)=temp;
        
        %C211
        temp=reshape(WC211_02(i,:,:),12,12)+p*errC211.*reshape(y102(i,:,:),12,12);
        newWC211_02(i,:,:)=temp;
        temp=reshape(WC211_06(i,:,:),12,12)+p*errC211.*reshape(y106(i,:,:),12,12);
        newWC211_06(i,:,:)=temp;
        temp=reshape(WC211_07(i,:,:),12,12)+p*errC211.*reshape(y107(i,:,:),12,12);
        newWC211_07(i,:,:)=temp;
        
        %C212
        temp=reshape(WC212_02(i,:,:),12,12)+p*errC212.*reshape(y102(i,:,:),12,12);
        newWC212_02(i,:,:)=temp;
        temp=reshape(WC212_07(i,:,:),12,12)+p*errC212.*reshape(y107(i,:,:),12,12);
        newWC212_07(i,:,:)=temp;
        temp=reshape(WC212_08(i,:,:),12,12)+p*errC212.*reshape(y108(i,:,:),12,12);
        newWC212_08(i,:,:)=temp;

        %C213
        temp=reshape(WC213_02(i,:,:),12,12)+p*errC213.*reshape(y102(i,:,:),12,12);
        newWC213_02(i,:,:)=temp;
        temp=reshape(WC213_08(i,:,:),12,12)+p*errC213.*reshape(y108(i,:,:),12,12);
        newWC213_08(i,:,:)=temp;
        
        %C214
        temp=reshape(WC214_03(i,:,:),12,12)+p*errC214.*reshape(y103(i,:,:),12,12);
        newWC214_03(i,:,:)=temp;
        temp=reshape(WC214_04(i,:,:),12,12)+p*errC214.*reshape(y104(i,:,:),12,12);
        newWC214_04(i,:,:)=temp;
        temp=reshape(WC214_05(i,:,:),12,12)+p*errC214.*reshape(y105(i,:,:),12,12);
        newWC214_05(i,:,:)=temp;
        
        %C215
        temp=reshape(WC215_03(i,:,:),12,12)+p*errC215.*reshape(y103(i,:,:),12,12);
        newWC215_03(i,:,:)=temp;
        temp=reshape(WC215_05(i,:,:),12,12)+p*errC215.*reshape(y105(i,:,:),12,12);
        newWC215_05(i,:,:)=temp;
        temp=reshape(WC215_06(i,:,:),12,12)+p*errC215.*reshape(y106(i,:,:),12,12);
        newWC215_06(i,:,:)=temp;
        
        %C216
        temp=reshape(WC216_03(i,:,:),12,12)+p*errC216.*reshape(y103(i,:,:),12,12);
        newWC216_03(i,:,:)=temp;
        temp=reshape(WC216_06(i,:,:),12,12)+p*errC216.*reshape(y106(i,:,:),12,12);
        newWC216_06(i,:,:)=temp;
        temp=reshape(WC216_07(i,:,:),12,12)+p*errC216.*reshape(y107(i,:,:),12,12);
        newWC216_07(i,:,:)=temp;
        
        %C217
        temp=reshape(WC217_03(i,:,:),12,12)+p*errC217.*reshape(y103(i,:,:),12,12);
        newWC217_03(i,:,:)=temp;
        temp=reshape(WC217_07(i,:,:),12,12)+p*errC217.*reshape(y107(i,:,:),12,12);
        newWC217_07(i,:,:)=temp;
        temp=reshape(WC217_08(i,:,:),12,12)+p*errC217.*reshape(y108(i,:,:),12,12);
        newWC217_08(i,:,:)=temp;
        
        %C218
        temp=reshape(WC218_03(i,:,:),12,12)+p*errC218.*reshape(y103(i,:,:),12,12);
        newWC218_03(i,:,:)=temp;
        temp=reshape(WC218_08(i,:,:),12,12)+p*errC218.*reshape(y108(i,:,:),12,12);
        newWC218_08(i,:,:)=temp;
        
        %C219
        temp=reshape(WC219_04(i,:,:),12,12)+p*errC219.*reshape(y104(i,:,:),12,12);
        newWC219_04(i,:,:)=temp;
        temp=reshape(WC219_05(i,:,:),12,12)+p*errC219.*reshape(y105(i,:,:),12,12);
        newWC219_05(i,:,:)=temp;
        temp=reshape(WC219_06(i,:,:),12,12)+p*errC219.*reshape(y106(i,:,:),12,12);
        newWC219_06(i,:,:)=temp;
        
        %C220
        temp=reshape(WC220_04(i,:,:),12,12)+p*errC220.*reshape(y104(i,:,:),12,12);
        newWC220_04(i,:,:)=temp;
        temp=reshape(WC220_06(i,:,:),12,12)+p*errC220.*reshape(y106(i,:,:),12,12);
        newWC220_06(i,:,:)=temp;
        temp=reshape(WC220_07(i,:,:),12,12)+p*errC220.*reshape(y107(i,:,:),12,12);
        newWC220_07(i,:,:)=temp;
        
    end

    newbiasC201=cnet.biasC201+p*errC201;
    newbiasC202=cnet.biasC202+p*errC202;
    newbiasC203=cnet.biasC203+p*errC203;
    newbiasC204=cnet.biasC204+p*errC204;
    newbiasC205=cnet.biasC205+p*errC205;
    newbiasC206=cnet.biasC206+p*errC206;
    newbiasC207=cnet.biasC207+p*errC207;
    newbiasC208=cnet.biasC208+p*errC208;
    newbiasC209=cnet.biasC209+p*errC209;
    newbiasC210=cnet.biasC210+p*errC210;
    newbiasC211=cnet.biasC211+p*errC211;
    newbiasC212=cnet.biasC212+p*errC212;
    newbiasC213=cnet.biasC213+p*errC213;
    newbiasC214=cnet.biasC214+p*errC214;
    newbiasC215=cnet.biasC215+p*errC215;
    newbiasC216=cnet.biasC216+p*errC216;
    newbiasC217=cnet.biasC217+p*errC217;
    newbiasC218=cnet.biasC218+p*errC218;
    newbiasC219=cnet.biasC219+p*errC219;
    newbiasC220=cnet.biasC220+p*errC220;

    %% 
    % Layer S1
    WS1C101=cnet.WS1C101;
    WS1C102=cnet.WS1C102;
    WS1C103=cnet.WS1C103;
    WS1C104=cnet.WS1C104;
    WS1C105=cnet.WS1C105;
    WS1C106=cnet.WS1C106;
    WS1C107=cnet.WS1C107;
    WS1C108=cnet.WS1C108;

    errS101=errS1(:,:,1);
    errS102=errS1(:,:,2);
    errS103=errS1(:,:,3);
    errS104=errS1(:,:,4);
    errS105=errS1(:,:,5);
    errS106=errS1(:,:,6);
    errS107=errS1(:,:,7);
    errS108=errS1(:,:,8);

    yC101=yC1(:,:,1);
    yC102=yC1(:,:,2);
    yC103=yC1(:,:,3);
    yC104=yC1(:,:,4);
    yC105=yC1(:,:,5);
    yC106=yC1(:,:,6);
    yC107=yC1(:,:,7);
    yC108=yC1(:,:,8);

    for i=1:16
        i1=2*i-1;
        i2=2*i;
        for j=1:16
            j1=2*j-1;
            j2=2*j;
            uC101(i,j)=sum(sum(yC101(i1:i2,j1:j2)))/4;
            uC102(i,j)=sum(sum(yC102(i1:i2,j1:j2)))/4;
            uC103(i,j)=sum(sum(yC103(i1:i2,j1:j2)))/4;
            uC104(i,j)=sum(sum(yC104(i1:i2,j1:j2)))/4;
            uC105(i,j)=sum(sum(yC105(i1:i2,j1:j2)))/4;
            uC106(i,j)=sum(sum(yC106(i1:i2,j1:j2)))/4;
            uC107(i,j)=sum(sum(yC107(i1:i2,j1:j2)))/4;
            uC108(i,j)=sum(sum(yC108(i1:i2,j1:j2)))/4;
        end
    end

    newWS1C101=WS1C101+p*errS101*uC101;
    newWS1C102=WS1C102+p*errS102*uC102;
    newWS1C103=WS1C103+p*errS103*uC103;
    newWS1C104=WS1C104+p*errS104*uC104;
    newWS1C105=WS1C105+p*errS105*uC105;
    newWS1C106=WS1C106+p*errS106*uC106;
    newWS1C107=WS1C107+p*errS107*uC107;
    newWS1C108=WS1C108+p*errS108*uC108;

    newbiasS101=cnet.biasS101+p*errS101;
    newbiasS102=cnet.biasS102+p*errS102;
    newbiasS103=cnet.biasS103+p*errS103;
    newbiasS104=cnet.biasS104+p*errS104;
    newbiasS105=cnet.biasS105+p*errS105;
    newbiasS106=cnet.biasS106+p*errS106;
    newbiasS107=cnet.biasS107+p*errS107;
    newbiasS108=cnet.biasS108+p*errS108;

    %%
    % Layer C1
     WC101=cnet.WC101;
     WC102=cnet.WC102;
     WC103=cnet.WC103;
     WC104=cnet.WC104;
     WC105=cnet.WC105;
     WC106=cnet.WC106;
     WC107=cnet.WC107;
     WC108=cnet.WC108;

     for i=1:32
         for j=1:32
             inpC1(:,i,j)=reshape(input(i:i+4,j:j+4),1,[]);
         end
     end
      for i=1:25
          tC1=reshape(WC101(i,:,:),32,32)+p*errC1(:,:,1).*reshape(inpC1(i,:,:),32,32);
          newWC101(i,:,:)=tC1;

          tC2=reshape(WC102(i,:,:),32,32)+p*errC1(:,:,2).*reshape(inpC1(i,:,:),32,32);
          newWC102(i,:,:)=tC2;

          tC3=reshape(WC103(i,:,:),32,32)+p*errC1(:,:,3).*reshape(inpC1(i,:,:),32,32);
          newWC103(i,:,:)=tC3;

          tC4=reshape(WC104(i,:,:),32,32)+p*errC1(:,:,4).*reshape(inpC1(i,:,:),32,32);
          newWC104(i,:,:)=tC4;
          
          tC5=reshape(WC105(i,:,:),32,32)+p*errC1(:,:,5).*reshape(inpC1(i,:,:),32,32);
          newWC105(i,:,:)=tC5;
          
          tC6=reshape(WC106(i,:,:),32,32)+p*errC1(:,:,6).*reshape(inpC1(i,:,:),32,32);
          newWC106(i,:,:)=tC6;
          
          tC7=reshape(WC107(i,:,:),32,32)+p*errC1(:,:,7).*reshape(inpC1(i,:,:),32,32);
          newWC107(i,:,:)=tC7;
          
          tC8=reshape(WC108(i,:,:),32,32)+p*errC1(:,:,8).*reshape(inpC1(i,:,:),32,32);
          newWC108(i,:,:)=tC8;
      end

      newbiasC101=cnet.biasC101+p*errC1(:,:,1);
      newbiasC102=cnet.biasC102+p*errC1(:,:,2);
      newbiasC103=cnet.biasC103+p*errC1(:,:,3);
      newbiasC104=cnet.biasC104+p*errC1(:,:,4);
      newbiasC105=cnet.biasC105+p*errC1(:,:,5);
      newbiasC106=cnet.biasC106+p*errC1(:,:,6);
      newbiasC107=cnet.biasC107+p*errC1(:,:,7);
      newbiasC108=cnet.biasC108+p*errC1(:,:,8);

    %% Save into the CovNN
    % Layer C1
    cnet.WC101=newWC101;
    cnet.WC102=newWC102;
    cnet.WC103=newWC103;
    cnet.WC104=newWC104;
    cnet.WC105=newWC105;
    cnet.WC106=newWC106;
    cnet.WC107=newWC107;
    cnet.WC108=newWC108;

    cnet.biasC101=newbiasC101;
    cnet.biasC102=newbiasC102;
    cnet.biasC103=newbiasC103;
    cnet.biasC104=newbiasC104;
    cnet.biasC105=newbiasC105;
    cnet.biasC106=newbiasC106;
    cnet.biasC107=newbiasC107;
    cnet.biasC108=newbiasC108;

    % Layer S1
    cnet.WS1C101=newWS1C101;
    cnet.WS1C102=newWS1C102;
    cnet.WS1C103=newWS1C103;
    cnet.WS1C104=newWS1C104;
    cnet.WS1C105=newWS1C105;
    cnet.WS1C106=newWS1C106;
    cnet.WS1C107=newWS1C107;
    cnet.WS1C108=newWS1C108;
    
    cnet.biasS101=newbiasS101;
    cnet.biasS102=newbiasS102;
    cnet.biasS103=newbiasS103;
    cnet.biasS104=newbiasS104;
    cnet.biasS105=newbiasS105;
    cnet.biasS106=newbiasS106;
    cnet.biasS107=newbiasS107;
    cnet.biasS108=newbiasS108;

    % Layer C2
    cnet.WC201_01=newWC201_01;
    cnet.WC201_02=newWC201_02;
    cnet.WC201_03=newWC201_03;

    cnet.WC202_01=newWC202_01;
    cnet.WC202_03=newWC202_03;
    cnet.WC202_04=newWC202_04;

    cnet.WC203_01=newWC203_01;
    cnet.WC203_04=newWC203_04;
    cnet.WC203_05=newWC203_05;

    cnet.WC204_01=newWC204_01;
    cnet.WC204_05=newWC204_05;
    cnet.WC204_06=newWC204_06;

    cnet.WC205_01=newWC205_01;
    cnet.WC205_06=newWC205_06;
    cnet.WC205_07=newWC205_07;

    cnet.WC206_01=newWC206_01;
    cnet.WC206_07=newWC206_07;
    cnet.WC206_08=newWC206_08;

    cnet.WC207_01=newWC207_01;
    cnet.WC207_08=newWC207_08;

    cnet.WC208_02=newWC208_02;
    cnet.WC208_03=newWC208_03;
    cnet.WC208_04=newWC208_04;

    cnet.WC209_02=newWC209_02;
    cnet.WC209_04=newWC209_04;
    cnet.WC209_05=newWC209_05;

    cnet.WC210_02=newWC210_02;
    cnet.WC210_05=newWC210_05;
    cnet.WC210_06=newWC210_06;
    
    cnet.WC211_02=newWC211_02;
    cnet.WC211_06=newWC211_06;
    cnet.WC211_07=newWC211_07;
    
    cnet.WC212_02=newWC212_02;
    cnet.WC212_07=newWC212_07;
    cnet.WC212_08=newWC212_08;
    
    cnet.WC213_02=newWC213_02;
    cnet.WC213_08=newWC213_08;
    
    cnet.WC214_03=newWC214_03;
    cnet.WC214_04=newWC214_04;
    cnet.WC214_05=newWC214_05;

    cnet.WC215_03=newWC215_03;
    cnet.WC215_05=newWC215_05;
    cnet.WC215_06=newWC215_06;
    
    cnet.WC216_03=newWC216_03;
    cnet.WC216_06=newWC216_06;
    cnet.WC216_07=newWC216_07;
    
    cnet.WC217_03=newWC217_03;
    cnet.WC217_07=newWC217_07;
    cnet.WC217_08=newWC217_08;
    
    cnet.WC218_03=newWC218_03;
    cnet.WC218_08=newWC218_08;
    
    cnet.WC219_04=newWC219_04;
    cnet.WC219_05=newWC219_05;
    cnet.WC219_06=newWC219_06;
    
    cnet.WC220_04=newWC220_04;
    cnet.WC220_06=newWC220_06;
    cnet.WC220_07=newWC220_07;

    cnet.biasC201=newbiasC201;
    cnet.biasC202=newbiasC202;
    cnet.biasC203=newbiasC203;
    cnet.biasC204=newbiasC204;
    cnet.biasC205=newbiasC205;
    cnet.biasC206=newbiasC206;
    cnet.biasC207=newbiasC207;
    cnet.biasC208=newbiasC208;
    cnet.biasC209=newbiasC209;
    cnet.biasC210=newbiasC210;
    cnet.biasC211=newbiasC211;
    cnet.biasC212=newbiasC212;
    cnet.biasC213=newbiasC213;
    cnet.biasC214=newbiasC214;
    cnet.biasC215=newbiasC215;
    cnet.biasC216=newbiasC216;
    cnet.biasC217=newbiasC217;
    cnet.biasC218=newbiasC218;
    cnet.biasC219=newbiasC219;
    cnet.biasC220=newbiasC220;

    % layer S2
    cnet.WS2C201=newWS2C201;
    cnet.WS2C202=newWS2C202;
    cnet.WS2C203=newWS2C203;
    cnet.WS2C204=newWS2C204;
    cnet.WS2C205=newWS2C205;
    cnet.WS2C206=newWS2C206;
    cnet.WS2C207=newWS2C207;
    cnet.WS2C208=newWS2C208;
    cnet.WS2C209=newWS2C209;
    cnet.WS2C210=newWS2C210;
    cnet.WS2C211=newWS2C211;
    cnet.WS2C212=newWS2C212;
    cnet.WS2C213=newWS2C213;
    cnet.WS2C214=newWS2C214;
    cnet.WS2C215=newWS2C215;
    cnet.WS2C216=newWS2C216;
    cnet.WS2C217=newWS2C217;
    cnet.WS2C218=newWS2C218;
    cnet.WS2C219=newWS2C219;
    cnet.WS2C220=newWS2C220;
    
    cnet.biasS201=newbiasS201;
    cnet.biasS202=newbiasS202;
    cnet.biasS203=newbiasS203;
    cnet.biasS204=newbiasS204;
    cnet.biasS205=newbiasS205;
    cnet.biasS206=newbiasS206;
    cnet.biasS207=newbiasS207;
    cnet.biasS208=newbiasS208;
    cnet.biasS209=newbiasS209;
    cnet.biasS210=newbiasS210;
    cnet.biasS211=newbiasS211;
    cnet.biasS212=newbiasS212;
    cnet.biasS213=newbiasS213;
    cnet.biasS214=newbiasS214;
    cnet.biasS215=newbiasS215;
    cnet.biasS216=newbiasS216;
    cnet.biasS217=newbiasS217;
    cnet.biasS218=newbiasS218;
    cnet.biasS219=newbiasS219;
    cnet.biasS220=newbiasS220;

    % layer N1
    cnet.WN001=newWN001;
    cnet.WN002=newWN002;
    cnet.WN003=newWN003;
    cnet.WN004=newWN004;
    cnet.WN005=newWN005;
    cnet.WN006=newWN006;
    cnet.WN007=newWN007;
    cnet.WN008=newWN008;
    cnet.WN009=newWN009;
    cnet.WN010=newWN010;
    cnet.WN011=newWN011;
    cnet.WN012=newWN012;
    cnet.WN013=newWN013;
    cnet.WN014=newWN014;
    cnet.WN015=newWN015;
    cnet.WN016=newWN016;
    cnet.WN017=newWN017;
    cnet.WN018=newWN018;
    cnet.WN019=newWN019;
    cnet.WN020=newWN020;
    cnet.WN021=newWN021;
    cnet.WN022=newWN022;
    cnet.WN023=newWN023;
    cnet.WN024=newWN024;
    cnet.WN025=newWN025;
    cnet.WN026=newWN026;
    cnet.WN027=newWN027;
    cnet.WN028=newWN028;
    cnet.WN029=newWN029;
    cnet.WN030=newWN030;
    cnet.WN031=newWN031;
    cnet.WN032=newWN032;
    cnet.WN033=newWN033;
    cnet.WN034=newWN034;
    cnet.WN035=newWN035;
    cnet.WN036=newWN036;
    cnet.WN037=newWN037;
    cnet.WN038=newWN038;
    cnet.WN039=newWN039;
    cnet.WN040=newWN040;
    cnet.WN041=newWN041;
    cnet.WN042=newWN042;
    cnet.WN043=newWN043;
    cnet.WN044=newWN044;
    cnet.WN045=newWN045;
    cnet.WN046=newWN046;
    cnet.WN047=newWN047;
    cnet.WN048=newWN048;
    cnet.WN049=newWN049;
    cnet.WN050=newWN050;
    cnet.WN051=newWN051;
    cnet.WN052=newWN052;
    cnet.WN053=newWN053;
    cnet.WN054=newWN054;
    cnet.WN055=newWN055;
    cnet.WN056=newWN056;
    cnet.WN057=newWN057;
    cnet.WN058=newWN058;
    cnet.WN059=newWN059;
    cnet.WN060=newWN060;
    cnet.WN061=newWN061;
    cnet.WN062=newWN062;
    cnet.WN063=newWN063;
    cnet.WN064=newWN064;
    cnet.WN065=newWN065;
    cnet.WN066=newWN066;
    cnet.WN067=newWN067;
    cnet.WN068=newWN068;
    cnet.WN069=newWN069;
    cnet.WN070=newWN070;
    cnet.WN071=newWN071;
    cnet.WN072=newWN072;
    cnet.WN073=newWN073;
    cnet.WN074=newWN074;
    cnet.WN075=newWN075;
    cnet.WN076=newWN076;
    cnet.WN077=newWN077;
    cnet.WN078=newWN078;
    cnet.WN079=newWN079;
    cnet.WN080=newWN080;
    cnet.WN081=newWN081;
    cnet.WN082=newWN082;
    cnet.WN083=newWN083;
    cnet.WN084=newWN084;
    cnet.WN085=newWN085;
    cnet.WN086=newWN086;
    cnet.WN087=newWN087;
    cnet.WN088=newWN088;
    cnet.WN089=newWN089;
    cnet.WN090=newWN090;
    cnet.WN091=newWN091;
    cnet.WN092=newWN092;
    cnet.WN093=newWN093;
    cnet.WN094=newWN094;
    cnet.WN095=newWN095;
    cnet.WN096=newWN096;
    cnet.WN097=newWN097;
    cnet.WN098=newWN098;
    cnet.WN099=newWN099;
    cnet.WN100=newWN100;
    cnet.WN101=newWN101;
    cnet.WN102=newWN102;
    cnet.WN103=newWN103;
    cnet.WN104=newWN104;
    cnet.WN105=newWN105;
    cnet.WN106=newWN106;
    cnet.WN107=newWN107;
    cnet.WN108=newWN108;
    cnet.WN109=newWN109;
    cnet.WN110=newWN110;
    cnet.WN111=newWN111;
    cnet.WN112=newWN112;
    cnet.WN113=newWN113;
    cnet.WN114=newWN114;
    cnet.WN115=newWN115;
    cnet.WN116=newWN116;
    cnet.WN117=newWN117;
    cnet.WN118=newWN118;
    cnet.WN119=newWN119;
    cnet.WN120=newWN120;
    cnet.WN121=newWN121;
    cnet.WN122=newWN122;
    cnet.WN123=newWN123;
    cnet.WN124=newWN124;
    cnet.WN125=newWN125;
    cnet.WN126=newWN126;
    cnet.WN127=newWN127;
    cnet.WN128=newWN128;
    cnet.WN129=newWN129;
    cnet.WN130=newWN130;
    cnet.WN131=newWN131;
    cnet.WN132=newWN132;
    cnet.WN133=newWN133;
    cnet.WN134=newWN134;
    cnet.WN135=newWN135;
    cnet.WN136=newWN136;
    cnet.WN137=newWN137;
    cnet.WN138=newWN138;
    cnet.WN139=newWN139;
    cnet.WN140=newWN140;
    cnet.WN141=newWN141;
    cnet.WN142=newWN142;
    cnet.WN143=newWN143;
    cnet.WN144=newWN144;
    cnet.WN145=newWN145;
    cnet.WN146=newWN146;
    cnet.WN147=newWN147;
    cnet.WN148=newWN148;
    cnet.WN149=newWN149;
    cnet.WN150=newWN150;
    cnet.WN151=newWN151;
    cnet.WN152=newWN152;
    cnet.WN153=newWN153;
    cnet.WN154=newWN154;
    cnet.WN155=newWN155;
    cnet.WN156=newWN156;
    cnet.WN157=newWN157;
    cnet.WN158=newWN158;
    cnet.WN159=newWN159;
    cnet.WN160=newWN160;
    cnet.WN161=newWN161;
    cnet.WN162=newWN162;
    cnet.WN163=newWN163;
    cnet.WN164=newWN164;
    cnet.WN165=newWN165;
    cnet.WN166=newWN166;
    cnet.WN167=newWN167;
    cnet.WN168=newWN168;
    cnet.WN169=newWN169;
    cnet.WN170=newWN170;
    cnet.WN171=newWN171;
    cnet.WN172=newWN172;
    cnet.WN173=newWN173;

    cnet.biasN001=newbiasN001;
    cnet.biasN002=newbiasN002;
    cnet.biasN003=newbiasN003;
    cnet.biasN004=newbiasN004;
    cnet.biasN005=newbiasN005;
    cnet.biasN006=newbiasN006;
    cnet.biasN007=newbiasN007;
    cnet.biasN008=newbiasN008;
    cnet.biasN009=newbiasN009;
    cnet.biasN010=newbiasN010;
    cnet.biasN011=newbiasN011;
    cnet.biasN012=newbiasN012;
    cnet.biasN013=newbiasN013;
    cnet.biasN014=newbiasN014;
    cnet.biasN015=newbiasN015;
    cnet.biasN016=newbiasN016;
    cnet.biasN017=newbiasN017;
    cnet.biasN018=newbiasN018;
    cnet.biasN019=newbiasN019;
    cnet.biasN020=newbiasN020;
    cnet.biasN021=newbiasN021;
    cnet.biasN022=newbiasN022;
    cnet.biasN023=newbiasN023;
    cnet.biasN024=newbiasN024;
    cnet.biasN025=newbiasN025;
    cnet.biasN026=newbiasN026;
    cnet.biasN027=newbiasN027;
    cnet.biasN028=newbiasN028;
    cnet.biasN029=newbiasN029;
    cnet.biasN030=newbiasN030;
    cnet.biasN031=newbiasN031;
    cnet.biasN032=newbiasN032;
    cnet.biasN033=newbiasN033;
    cnet.biasN034=newbiasN034;
    cnet.biasN035=newbiasN035;
    cnet.biasN036=newbiasN036;
    cnet.biasN037=newbiasN037;
    cnet.biasN038=newbiasN038;
    cnet.biasN039=newbiasN039;
    cnet.biasN040=newbiasN040;
    cnet.biasN041=newbiasN041;
    cnet.biasN042=newbiasN042;
    cnet.biasN043=newbiasN043;
    cnet.biasN044=newbiasN044;
    cnet.biasN045=newbiasN045;
    cnet.biasN046=newbiasN046;
    cnet.biasN047=newbiasN047;
    cnet.biasN048=newbiasN048;
    cnet.biasN049=newbiasN049;
    cnet.biasN050=newbiasN050;
    cnet.biasN051=newbiasN051;
    cnet.biasN052=newbiasN052;
    cnet.biasN053=newbiasN053;
    cnet.biasN054=newbiasN054;
    cnet.biasN055=newbiasN055;
    cnet.biasN056=newbiasN056;
    cnet.biasN057=newbiasN057;
    cnet.biasN058=newbiasN058;
    cnet.biasN059=newbiasN059;
    cnet.biasN060=newbiasN060;
    cnet.biasN061=newbiasN061;
    cnet.biasN062=newbiasN062;
    cnet.biasN063=newbiasN063;
    cnet.biasN064=newbiasN064;
    cnet.biasN065=newbiasN065;
    cnet.biasN066=newbiasN066;
    cnet.biasN067=newbiasN067;
    cnet.biasN068=newbiasN068;
    cnet.biasN069=newbiasN069;
    cnet.biasN070=newbiasN070;
    cnet.biasN071=newbiasN071;
    cnet.biasN072=newbiasN072;
    cnet.biasN073=newbiasN073;
    cnet.biasN074=newbiasN074;
    cnet.biasN075=newbiasN075;
    cnet.biasN076=newbiasN076;
    cnet.biasN077=newbiasN077;
    cnet.biasN078=newbiasN078;
    cnet.biasN079=newbiasN079;
    cnet.biasN080=newbiasN080;
    cnet.biasN081=newbiasN081;
    cnet.biasN082=newbiasN082;
    cnet.biasN083=newbiasN083;
    cnet.biasN084=newbiasN084;
    cnet.biasN085=newbiasN085;
    cnet.biasN086=newbiasN086;
    cnet.biasN087=newbiasN087;
    cnet.biasN088=newbiasN088;
    cnet.biasN089=newbiasN089;
    cnet.biasN090=newbiasN090;
    cnet.biasN091=newbiasN091;
    cnet.biasN092=newbiasN092;
    cnet.biasN093=newbiasN093;
    cnet.biasN094=newbiasN094;
    cnet.biasN095=newbiasN095;
    cnet.biasN096=newbiasN096;
    cnet.biasN097=newbiasN097;
    cnet.biasN098=newbiasN098;
    cnet.biasN099=newbiasN099;
    cnet.biasN100=newbiasN100;
    cnet.biasN101=newbiasN101;
    cnet.biasN102=newbiasN102;
    cnet.biasN103=newbiasN103;
    cnet.biasN104=newbiasN104;
    cnet.biasN105=newbiasN105;
    cnet.biasN106=newbiasN106;
    cnet.biasN107=newbiasN107;
    cnet.biasN108=newbiasN108;
    cnet.biasN109=newbiasN109;
    cnet.biasN110=newbiasN110;
    cnet.biasN111=newbiasN111;
    cnet.biasN112=newbiasN112;
    cnet.biasN113=newbiasN113;
    cnet.biasN114=newbiasN114;
    cnet.biasN115=newbiasN115;
    cnet.biasN116=newbiasN116;
    cnet.biasN117=newbiasN117;
    cnet.biasN118=newbiasN118;
    cnet.biasN119=newbiasN119;
    cnet.biasN120=newbiasN120;
    cnet.biasN121=newbiasN121;
    cnet.biasN122=newbiasN122;
    cnet.biasN123=newbiasN123;
    cnet.biasN124=newbiasN124;
    cnet.biasN125=newbiasN125;
    cnet.biasN126=newbiasN126;
    cnet.biasN127=newbiasN127;
    cnet.biasN128=newbiasN128;
    cnet.biasN129=newbiasN129;
    cnet.biasN130=newbiasN130;
    cnet.biasN131=newbiasN131;
    cnet.biasN132=newbiasN132;
    cnet.biasN133=newbiasN133;
    cnet.biasN134=newbiasN134;
    cnet.biasN135=newbiasN135;
    cnet.biasN136=newbiasN136;
    cnet.biasN137=newbiasN137;
    cnet.biasN138=newbiasN138;
    cnet.biasN139=newbiasN139;
    cnet.biasN140=newbiasN140;
    cnet.biasN141=newbiasN141;
    cnet.biasN142=newbiasN142;
    cnet.biasN143=newbiasN143;
    cnet.biasN144=newbiasN144;
    cnet.biasN145=newbiasN145;
    cnet.biasN146=newbiasN146;
    cnet.biasN147=newbiasN147;
    cnet.biasN148=newbiasN148;
    cnet.biasN149=newbiasN149;
    cnet.biasN150=newbiasN150;
    cnet.biasN151=newbiasN151;
    cnet.biasN152=newbiasN152;
    cnet.biasN153=newbiasN153;
    cnet.biasN154=newbiasN154;
    cnet.biasN155=newbiasN155;
    cnet.biasN156=newbiasN156;
    cnet.biasN157=newbiasN157;
    cnet.biasN158=newbiasN158;
    cnet.biasN159=newbiasN159;
    cnet.biasN160=newbiasN160;
    cnet.biasN161=newbiasN161;
    cnet.biasN162=newbiasN162;
    cnet.biasN163=newbiasN163;
    cnet.biasN164=newbiasN164;
    cnet.biasN165=newbiasN165;
    cnet.biasN166=newbiasN166;
    cnet.biasN167=newbiasN167;
    cnet.biasN168=newbiasN168;
    cnet.biasN169=newbiasN169;
    cnet.biasN170=newbiasN170;
    cnet.biasN171=newbiasN171;
    cnet.biasN172=newbiasN172;
    cnet.biasN173=newbiasN173;
    
end